<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineTool - AI Film Production Assistant</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-container">
        <!-- Top Navigation Bar with Logo -->
        <nav class="top-nav">
            <div class="logo-section">
                <span class="logo-icon">üé¨</span>
                <span class="logo-text">CineTool</span>
            </div>
            <div class="nav-tabs">
                <button class="nav-tab active" data-tab="scriptInput" onclick="switchScreen('scriptInput')">
                    üìù Nh·∫≠p K·ªãch B·∫£n
                </button>
                <button class="nav-tab" data-tab="analyzedInput" onclick="switchScreen('analyzedInput')">
                    üéØ K·ªãch B·∫£n ƒê√£ Ph√¢n T√≠ch
                </button>
                <button class="nav-tab" data-tab="jsonFilter" onclick="switchScreen('jsonFilter')">
                    üîß L·ªçc JSON
                </button>
                <button class="nav-tab" data-tab="imageGen" onclick="switchScreen('imageGen')">
                    üñºÔ∏è T·∫°o ·∫¢nh
                </button>
            </div>
        </nav>

        <!-- Shared Settings Panel (visible on all tabs) -->
        <aside class="settings-panel">
            <h3>‚öôÔ∏è C√†i ƒë·∫∑t</h3>

            <div class="setting-group">
                <label for="styleSelect">Phong c√°ch l√†m phim</label>
                <select id="styleSelect">
                    <option value="cinematic">Cinematic - Phong c√°ch ƒëi·ªán ·∫£nh</option>
                    <option value="cyberpunk">Cyberpunk - Khoa h·ªçc vi·ªÖn t∆∞·ªüng</option>
                    <option value="realistic">Realistic - Th·ª±c t·∫ø</option>
                    <option value="horror">Horror - Kinh d·ªã</option>
                    <option value="fantasy">Fantasy - K·ª≥ ·∫£o</option>
                    <option value="3d_pixar">3D Pixar - Ho·∫°t h√¨nh 3D</option>
                    <option value="2d_cartoon">2D Cartoon - Ho·∫°t h√¨nh 2D</option>
                    <option value="2d_anime">2D Anime - Anime Nh·∫≠t</option>
                    <option value="retro">Retro - C·ªï ƒëi·ªÉn</option>
                    <option value="vintage">Vintage - Ho√†i ni·ªám</option>
                </select>
            </div>

            <div class="setting-group">
                <label for="dialogueLanguageSelect">Ng√¥n ng·ªØ ƒë·ªëi tho·∫°i</label>
                <select id="dialogueLanguageSelect">
                    <option value="vi-VN">Ti·∫øng Vi·ªát</option>
                    <option value="en-US">English</option>
                    <option value="zh-CN">‰∏≠Êñá</option>
                    <option value="ja-JP">Êó•Êú¨Ë™û</option>
                    <option value="ko-KR">ÌïúÍµ≠Ïñ¥</option>
                </select>
            </div>

            <div class="setting-group">
                <label for="durationInput">Th·ªùi l∆∞·ª£ng video (gi√¢y)</label>
                <input type="number" id="durationInput" value="24" min="8" max="120" step="8">
                <small>M·ªói c·∫£nh 8 gi√¢y. T·ªïng: <span id="sceneCountDisplay">3</span> c·∫£nh</small>
            </div>

            <div class="setting-group">
                <label for="aspectRatioSelect">T·ª∑ l·ªá khung h√¨nh</label>
                <select id="aspectRatioSelect">
                    <option value="16:9">16:9 (YouTube, TV)</option>
                    <option value="9:16">9:16 (TikTok, Instagram Stories)</option>
                </select>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Tab 1: Script Input -->
            <section id="scriptInput" class="tab-panel active">
                <div class="content-wrapper">
                    <div class="input-section">
                        <label for="scriptInputArea">N·ªôi dung k·ªãch b·∫£n phim</label>
                        <textarea id="scriptInputArea"
                            placeholder="Nh·∫≠p √Ω t∆∞·ªüng k·ªãch b·∫£n c·ªßa b·∫°n t·∫°i ƒë√¢y...&#10;&#10;V√≠ d·ª•: M·ªôt c·∫≠u b√© s·ªëng ·ªü m·ªôt l√†ng ch√†i nh·ªè nh·∫∑t ƒë∆∞·ª£c m·ªôt chi·∫øc la b√†n c≈© k·ªπ kh√¥ng ch·ªâ v·ªÅ h∆∞·ªõng b·∫Øc m√† ch·ªâ v·ªÅ th·ª© c·∫≠u b√© mong mu·ªën nh·∫•t."
                            rows="10"></textarea>
                    </div>

                    <div class="button-group">
                        <button id="copyPromptBtn" class="btn btn-primary">
                            üìã Copy Prompt Ph√¢n T√≠ch K·ªãch B·∫£n
                        </button>
                    </div>

                    <div id="copyNotification1" class="notification">‚úì ƒê√£ copy prompt v√†o clipboard!</div>
                </div>
            </section>

            <!-- Tab 2: Analyzed Script Input -->
            <section id="analyzedInput" class="tab-panel">
                <div class="content-wrapper">
                    <div class="input-section">
                        <label for="analyzedScriptInput">K·ªãch b·∫£n ƒë√£ ƒë∆∞·ª£c ph√¢n t√≠ch</label>
                        <textarea id="analyzedScriptInput" placeholder="D√°n k·ªãch b·∫£n ƒë√£ ƒë∆∞·ª£c ph√¢n t√≠ch t·ª´ AI v√†o ƒë√¢y..."
                            rows="15"></textarea>
                    </div>

                    <div class="button-group">
                        <button id="copyJsonPromptBtn" class="btn btn-primary">
                            üìã Copy Prompt Sinh JSON
                        </button>
                    </div>

                    <div id="copyNotification2" class="notification">‚úì ƒê√£ copy prompt v√†o clipboard!</div>
                </div>
            </section>

            <!-- Tab 3: JSON Filter -->
            <section id="jsonFilter" class="tab-panel">
                <div class="content-wrapper split-view">
                    <div class="left-panel">
                        <h3>JSON Input</h3>
                        <textarea id="jsonInput"
                            placeholder='D√°n JSON t·ª´ AI v√†o ƒë√¢y...&#10;&#10;{&#10;  "masterConfig": { ... },&#10;  "scenePrompts": [ ... ]&#10;}'
                            rows="12"></textarea>
                        <button id="parseJsonBtn" class="btn btn-primary">üîÑ Ph√¢n T√≠ch JSON</button>
                    </div>

                    <div class="right-panel">
                        <div class="tabs">
                            <button class="tab-btn active" onclick="switchTab('scenes')">SCENES</button>
                            <button class="tab-btn" onclick="switchTab('references')">REFERENCES</button>
                        </div>

                        <div id="scenesTab" class="tab-content active">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="margin: 0;">Danh S√°ch C·∫£nh</h3>
                                <button onclick="copyAllScenes(event)" class="copy-btn" style="padding: 10px 20px;">
                                    üìã Copy To√†n B·ªô Scenes
                                </button>
                            </div>
                            <div id="scenesOutput" class="output-content">
                                <p class="placeholder">Ch∆∞a c√≥ d·ªØ li·ªáu. Vui l√≤ng nh·∫≠p JSON v√† nh·∫•n "Ph√¢n T√≠ch JSON".</p>
                            </div>
                        </div>

                        <div id="referencesTab" class="tab-content">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <button onclick="copyAllReferences(event)" class="copy-btn" style="padding: 10px 20px;">
                                    üìã Copy To√†n B·ªô Refs
                                </button>
                            </div>
                            <div id="referencesOutput" class="output-content">
                                <div class="reference-section">
                                    <div id="masterConfigOutput" class="code-block">
                                        <p class="placeholder">Ch∆∞a c√≥ d·ªØ li·ªáu.</p>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab 4: Image Generation -->
            <section id="imageGen" class="tab-panel">
                <div class="content-wrapper split-view">
                    <div class="left-panel">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h3 style="margin: 0;">JSON Input</h3>
                            <button onclick="showApiKeyManager()" class="btn btn-secondary" style="padding: 8px 16px; font-size: 0.9rem;">
                                üîë Qu·∫£n L√Ω API Key
                            </button>
                        </div>
                        <textarea id="imageJsonInput"
                            placeholder='D√°n JSON t·ª´ AI v√†o ƒë√¢y...&#10;&#10;{&#10;  "masterConfig": { ... },&#10;  "scenePrompts": [ ... ]&#10;}'
                            rows="12"></textarea>
                        <button id="parseImageJsonBtn" class="btn btn-primary">üîÑ Ph√¢n T√≠ch JSON</button>
                    </div>

                    <div class="right-panel">
                        <div class="tabs">
                            <button class="tab-btn active" onclick="switchImageTab('imageReferences')">REFERENCES</button>
                            <button class="tab-btn" onclick="switchImageTab('imageScenes')">SCENES</button>
                        </div>

                        <div id="imageReferencesTab" class="tab-content active">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="margin: 0;">References</h3>
                                <div style="display: flex; gap: 10px;">
                                    <button onclick="generateAllReferenceImages(event)" class="btn btn-primary" style="padding: 10px 20px;">
                                        üñºÔ∏è T·∫°o T·∫•t C·∫£ ·∫¢nh
                                    </button>
                                    <button onclick="downloadAllReferenceImages()" class="btn btn-secondary" style="padding: 10px 20px;">
                                        üíæ T·∫£i T·∫•t C·∫£ ·∫¢nh
                                    </button>
                                </div>
                            </div>
                            <div id="imageReferencesOutput" class="output-content">
                                <p class="placeholder">Ch∆∞a c√≥ d·ªØ li·ªáu. Vui l√≤ng nh·∫≠p JSON v√† nh·∫•n "Ph√¢n T√≠ch JSON".</p>
                            </div>
                        </div>

                        <div id="imageScenesTab" class="tab-content">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="margin: 0;">Scenes</h3>
                                <div style="display: flex; gap: 10px;">
                                    <button onclick="generateAllSceneImages(event)" class="btn btn-primary" style="padding: 10px 20px;">
                                        üñºÔ∏è T·∫°o T·∫•t C·∫£ ·∫¢nh
                                    </button>
                                    <button onclick="downloadAllSceneImages()" class="btn btn-secondary" style="padding: 10px 20px;">
                                        üíæ T·∫£i T·∫•t C·∫£ ·∫¢nh
                                    </button>
                                </div>
                            </div>
                            <div id="imageScenesOutput" class="output-content">
                                <p class="placeholder">Ch∆∞a c√≥ d·ªØ li·ªáu. Vui l√≤ng nh·∫≠p JSON v√† nh·∫•n "Ph√¢n T√≠ch JSON".</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal/Popup Container -->
    <div id="modalOverlay" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-icon"></span>
                <h3 class="modal-title"></h3>
            </div>
            <div class="modal-body"></div>
            <div class="modal-buttons"></div>
        </div>
    </div>

    <!-- Load modular scripts -->
    <script src="js/utils.js"></script>
    <script src="js/scriptInput.js"></script>
    <script src="js/analyzedInput.js"></script>
    <script src="js/jsonFilter.js"></script>
    <script src="js/imageGen.js"></script>
    <script src="js/navigation.js"></script>
</body>

</html>